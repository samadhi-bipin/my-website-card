<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Visa Interview: Kusum's Case</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .chat-container {
            max-width: 800px;
            height: 90vh;
            max-height: 800px;
        }
        .chat-bubble {
            max-width: 75%;
            padding: 12px 18px;
            border-radius: 20px;
            word-wrap: break-word;
        }
        .officer-bubble {
            background-color: #e5e7eb;
            color: #1f2937;
            border-bottom-left-radius: 4px;
        }
        .user-bubble {
            background-color: #3b82f6;
            color: white;
            border-bottom-right-radius: 4px;
        }
        .option-button {
            transition: all 0.2s ease-in-out;
        }
        .option-button:hover {
            transform: translateY(-2px);
            background-color: #2563eb;
        }
        .reasoning-bubble {
            background-color: #fefce8;
            color: #854d0e;
            border: 1px solid #fde047;
            font-size: 0.9rem;
        }
        .icon {
            width: 20px;
            height: 20px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        .progress-bar-bg {
            background-color: #e5e7eb;
        }
        .progress-bar {
            background-color: #3b82f6;
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100">

    <div id="game-container" class="w-full h-full">

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="flex flex-col items-center justify-center h-full text-center p-8">
            <img src="https://placehold.co/100x100/3b82f6/ffffff?text=AU" alt="Coat of Arms" class="rounded-full mb-4">
            <h1 class="text-4xl font-bold text-gray-800">The Visa Interview</h1>
            <h2 class="text-2xl font-semibold text-gray-600">Kusum's Case</h2>
            <p class="mt-4 max-w-2xl text-gray-500">You are about to begin your student visa interview. As Kusum Gurung, you must answer the Visa Officer's questions accurately and convincingly based on your application. Your responses will be critically evaluated. Good luck.</p>
            <button id="start-btn" class="mt-8 px-8 py-3 bg-blue-600 text-white font-bold rounded-full shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-105">Begin Interview</button>
        </div>

        <!-- Interview Screen -->
        <div id="interview-screen" class="hidden flex flex-col items-center justify-center w-full h-full">
            <div class="chat-container w-full bg-white rounded-2xl shadow-2xl flex flex-col p-4">
                <div class="flex-grow overflow-y-auto p-4 space-y-6" id="chat-box">
                    <!-- Chat messages will appear here -->
                </div>
                <div class="p-4 border-t border-gray-200" id="options-box">
                    <!-- Answer options will appear here -->
                </div>
                <div class="w-full p-4">
                    <div class="progress-bar-bg w-full rounded-full h-2.5">
                        <div id="progress-bar" class="progress-bar h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Final Screen -->
        <div id="final-screen" class="hidden flex flex-col items-center justify-center h-full text-center p-8">
             <h1 id="final-decision" class="text-5xl font-bold"></h1>
             <p class="mt-4 text-xl text-gray-600">Based on the interview, the following assessment has been made:</p>
             <div id="summary-box" class="mt-6 text-left max-w-2xl w-full bg-white p-6 rounded-lg shadow-md">
                 <!-- Summary will be injected here -->
             </div>
             <button id="restart-btn" class="mt-8 px-8 py-3 bg-blue-600 text-white font-bold rounded-full shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-105">Retry Interview</button>
        </div>

    </div>

    <script>
        // --- DATA ---
        const interviewData = [
            {
                question: "Good morning. Let's start with your choice of course. Why have you specifically chosen to study the Master of Research Studies at Torrens University?",
                options: [
                    { text: "It's a well-regarded university in Australia, and the course sounded interesting and practical for my future.", score: 5, reasoning: "This answer is generic. It doesn't show deep research into the specific course structure or how it aligns with your stated career goals. A strong applicant would provide more detail." },
                    { text: "Because it uniquely blends core research subjects with applied industry engagement, unlike the thesis-only programs in Nepal. Subjects like Applied Analytics are vital for my goal of founding an HR consultancy.", score: 20, reasoning: "This is a strong answer. It directly references the unique structure of the course and links specific subjects to your long-term career goals mentioned in the application. This demonstrates genuine interest and thorough research." },
                    { text: "Australia offers post-study work rights, and Torrens seemed like a good place to get a degree that allows me to stay and work for a while.", score: -5, reasoning: "This response raises a significant red flag. It focuses on post-study work rights rather than the academic value of the course, which can question your primary motivation as a genuine student." }
                ],
                searchQuery: "Torrens University Master of Research Studies structure"
            },
            {
                question: "I see. Let's discuss your financial arrangements. Your application states you have an education loan of NPR 7 million. How do you plan to manage your living expenses in Australia?",
                options: [
                    { text: "My family will support me. They have property valued at over NPR 20 million, so they can send money as needed.", score: 5, reasoning: "While your family's assets are noted, this answer lacks specific planning. It doesn't align with the detailed budget you provided in your application, suggesting you may not have thought through the practicalities." },
                    { text: "I plan to get a part-time job as soon as I arrive, which should cover all my living expenses.", score: -10, reasoning: "This is a very weak answer. Relying solely on potential part-time work is risky and contravenes the student visa requirement to have sufficient funds to support yourself without relying on work. It shows poor financial planning." },
                    { text: "I've budgeted for monthly costs of around AUD 2,200, covering rent, groceries, and transport, based on my research of suburbs like Footscray. My loan and personal funds are sufficient to cover these costs.", score: 20, reasoning: "Excellent. This answer is specific, realistic, and directly aligns with the detailed research presented in your application. It demonstrates that you are well-prepared for the financial realities of living in Australia." }
                ],
                searchQuery: "average rent Footscray VIC 1 bedroom"
            },
            {
                question: "Your application mentions a long-term goal of establishing an HR consultancy in Nepal. How will this specific Master's degree realistically help you achieve that?",
                options: [
                    { text: "Having a foreign degree, especially from Australia, will give me a lot of prestige and credibility back home, making it easier to attract clients.", score: 5, reasoning: "While a foreign degree may carry prestige, this answer is superficial. It doesn't explain how the *content* of the course will provide the skills needed to run a successful consultancy." },
                    { text: "The course's focus on research design and analytics will equip me to offer evidence-based HR solutions, a gap in the current market for SMEs in Nepal. This will be my consultancy's key differentiator.", score: 20, reasoning: "This is a very strong, strategic answer. You have identified a specific market gap in Nepal and clearly articulated how the skills gained from this particular course will allow you to fill it. This shows a clear and viable business plan." },
                    { text: "It will help me get a good job at a large company like Unilever first, where I can save enough money to eventually start my own business.", score: 0, reasoning: "This answer is plausible but focuses more on the financial aspect rather than the skills-based benefit of the degree. It slightly weakens the argument that this specific *research* degree is essential for your ultimate goal." }
                ],
                searchQuery: "HR consultancy services for SMEs in Nepal"
            },
            {
                question: "You have a stable career and strong family ties in Nepal. What are your most significant incentives to return to Nepal after completing your studies or any post-study work?",
                options: [
                    { text: "My primary incentive is my career plan to build my consultancy. Also, my husband and I have a duty to care for his mother, who is a single parent.", score: 20, reasoning: "This is a compelling answer. It combines a strong, credible professional incentive with a significant personal family obligation. This combination presents a very strong case for your intention to return." },
                    { text: "I will have to return to repay my education loan, which will be easier to do by earning a high salary in Nepal with my new qualification.", score: 5, reasoning: "While repaying a loan is a valid incentive, it's not the strongest one. Visa officers look for deeper professional and personal ties that pull you back to your home country, not just financial obligations." },
                    { text: "I'm not sure yet. I'd like to see what opportunities are available in Australia after I finish my studies before I make a final decision.", score: -20, reasoning: "This is a major red flag. It directly contradicts the requirement to be a 'Genuine Temporary Entrant' and strongly suggests you may not intend to return to Nepal, which could jeopardize your application." }
                ],
                searchQuery: "social security for single parents in Nepal"
            }
        ];

        // --- GAME STATE ---
        let currentQuestionIndex = 0;
        let confidenceScore = 50; // Start at a neutral score
        let lock = false;

        // --- DOM ELEMENTS ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const interviewScreen = document.getElementById('interview-screen');
        const finalScreen = document.getElementById('final-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const chatBox = document.getElementById('chat-box');
        const optionsBox = document.getElementById('options-box');
        const progressBar = document.getElementById('progress-bar');
        const finalDecision = document.getElementById('final-decision');
        const summaryBox = document.getElementById('summary-box');

        // --- FUNCTIONS ---
        function startGame() {
            welcomeScreen.classList.add('hidden');
            finalScreen.classList.add('hidden');
            interviewScreen.classList.remove('hidden');
            currentQuestionIndex = 0;
            confidenceScore = 50;
            chatBox.innerHTML = '';
            updateProgressBar();
            askQuestion();
        }

        function askQuestion() {
            lock = true;
            const questionData = interviewData[currentQuestionIndex];
            addMessage(questionData.question, 'officer');
            
            setTimeout(() => {
                optionsBox.innerHTML = '';
                questionData.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option.text;
                    button.className = "w-full text-left p-4 mb-2 bg-blue-500 text-white rounded-lg option-button shadow";
                    button.onclick = () => selectAnswer(option);
                    optionsBox.appendChild(button);
                });
                lock = false;
            }, 1000);
        }

        function selectAnswer(option) {
            if (lock) return;
            lock = true;
            optionsBox.innerHTML = '';
            addMessage(option.text, 'user');
            
            confidenceScore += option.score;
            if (confidenceScore > 100) confidenceScore = 100;
            if (confidenceScore < 0) confidenceScore = 0;

            setTimeout(() => {
                showReasoning(option);
            }, 1000);
        }

        async function showReasoning(option) {
            const officerThinkingBubble = addMessage('<div class="flex items-center"><div class="icon animate-spin">🤔</div>Thinking...</div>', 'officer', true);
            await sleep(2000);
            
            officerThinkingBubble.innerHTML = `<div class="flex items-center"><div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
            </div>Checking against application...</div>`;
            await sleep(2500);

            const officerSearchingBubble = addMessage('<div class="flex items-center"><div class="icon">🔍</div>Performing live verification...</div>', 'officer', true);
            await sleep(3000);
            
            officerSearchingBubble.remove();
            officerThinkingBubble.remove();

            addMessage(`<div class="reasoning-bubble chat-bubble"><strong>Officer's Assessment:</strong><br>${option.reasoning}</div>`, 'officer');
            
            setTimeout(() => {
                currentQuestionIndex++;
                updateProgressBar();
                if (currentQuestionIndex < interviewData.length) {
                    askQuestion();
                } else {
                    endGame();
                }
            }, 4000);
        }

        function endGame() {
            interviewScreen.classList.add('hidden');
            finalScreen.classList.remove('hidden');
            
            let decisionText = '';
            let decisionColor = '';
            let summaryHTML = '<h3 class="text-lg font-bold mb-2 border-b pb-2">Interview Assessment</h3>';
            
            if (confidenceScore >= 80) {
                decisionText = "Application Approved";
                decisionColor = 'text-green-600';
                summaryHTML += `<p class="text-green-700 font-semibold">✓ Consistently strong and well-researched answers.</p>`;
                summaryHTML += `<p class="text-green-700 font-semibold">✓ Clear alignment between academic goals and career path.</p>`;
                summaryHTML += `<p class="text-green-700 font-semibold">✓ Demonstrated significant ties and a credible intention to return.</p>`;
            } else if (confidenceScore >= 40) {
                decisionText = "Pending Further Review";
                decisionColor = 'text-yellow-600';
                summaryHTML += `<p class="text-yellow-700 font-semibold">~ Some answers were strong, but lacked consistency.</p>`;
                summaryHTML += `<p class="text-yellow-700 font-semibold">! The link between the course and long-term goals could be clearer.</p>`;
                summaryHTML += `<p class="text-yellow-700 font-semibold">! Intent to return is plausible but could be strengthened with more detail.</p>`;
            } else {
                decisionText = "Application at Risk";
                decisionColor = 'text-red-600';
                summaryHTML += `<p class="text-red-700 font-semibold">✗ Answers raised red flags regarding primary motivation.</p>`;
                summaryHTML += `<p class="text-red-700 font-semibold">✗ Financial planning appeared weak or overly reliant on uncertain factors.</p>`;
                summaryHTML += `<p class="text-red-700 font-semibold">✗ The intention to return to the home country was not convincingly demonstrated.</p>`;
            }
            
            finalDecision.textContent = decisionText;
            finalDecision.className = `text-5xl font-bold ${decisionColor}`;
            summaryBox.innerHTML = summaryHTML;
        }

        function addMessage(text, sender, isDynamic = false) {
            const bubble = document.createElement('div');
            bubble.className = `chat-bubble ${sender === 'officer' ? 'officer-bubble self-start' : 'user-bubble self-end'}`;
            bubble.innerHTML = text;
            chatBox.appendChild(bubble);
            chatBox.scrollTop = chatBox.scrollHeight;
            return isDynamic ? bubble : null;
        }
        
        function updateProgressBar() {
            const progress = (currentQuestionIndex / interviewData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);

    </script>
</body>
</html>
